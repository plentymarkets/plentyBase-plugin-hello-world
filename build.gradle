plugins {
    id 'java'
}

group 'eu.plentymarkets.plentybase.plugins'
version '1.0.0'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

dependencies {
    // https://mvnrepository.com/artifact/org.junit.jupiter/junit-jupiter-api
    testImplementation group: 'org.junit.jupiter', name: 'junit-jupiter-api', version: '5.4.1'

    compileOnly fileTree(dir: '{PATH TO plentyBase.jar HERE}', include: '*.jar')
    annotationProcessor fileTree(dir: '{PATH TO plentyBase.jar HERE}', include: '*.jar')

    // https://mvnrepository.com/artifact/org.pf4j/pf4j
    compileOnly group: 'org.pf4j', name: 'pf4j', version: '3.4.1'
    annotationProcessor group: 'org.pf4j', name: 'pf4j', version: '3.4.1'
}

task uberJar(type: Jar) {
    manifest {
        attributes(
                "Plugin-Class": "helloworld.HelloWorldPlugin",
                "Plugin-Id": "${project.name}",
                "Plugin-Version": "${project.version}",
                "Plugin-Description": "Description of my plentyBase plugin",
                "Plugin-Provider": "plentysystems AG")
    }

    from sourceSets.main.output

    dependsOn configurations.runtimeClasspath
    from {
        configurations.runtimeClasspath.findAll { it.name.endsWith('jar') }.collect { zipTree(it) }
    }
}